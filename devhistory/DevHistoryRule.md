## 프로젝트 목표 및 작업 가이드라인 (Project Goal & Working Guidelines)

### 1. 핵심 목표 (Core Objective)
이 프로젝트의 최종 목표는 `cpp-multiplayer-game-server` 프로젝트의 전체 개발 역사를 단계별 MVP로 완벽하게 재구현할 수 있도록, 상세하고 포괄적인 `DevHistory` 문서 시리즈를 작성하는 것입니다. 각 문서는 독립적으로 이해 가능해야 하며, 제3자가 해당 MVP를 재현하는 데 필요한 모든 정보를 담고 있어야 합니다.

### 2. 진실의 원천 (Single Source of Truth)
*   **코드:** `src` 디렉토리의 소스 코드가 **현재 상태의 유일한 진실의 원천**입니다.
*   **설계 명세:** 각 `DevHistoryXX.md` 문서는 각 MVP 단계의 설계 명세 역할을 하며, 코드와 100% 동기화되어야 합니다.
*   **참고용 타임라인:** `docs/development/DEVELOPMENT_JOURNEY.md` 파일은 개발 타임라인과 각 MVP의 개괄적인 범위를 참고하기 위한 용도로만 사용합니다. (현재 프로젝트에서는 해당 문서가 유실되었으니 무시하세요)

### 3. 시퀀스 번호 부여 원칙 (Sequence Numbering Principles)
*   **유일성 (Uniqueness):** 특정 MVP 내의 모든 시퀀스 번호는 유일해야 합니다. (예: `MVP4-21`은 MVP4 내에서 단 한 번만 사용될 수 있습니다.) 중복이 발견될 경우, 계획을 수립하여 유일한 번호로 재정렬합니다.
*   **역사성 (Historicity):** 기능이 여러 MVP에 걸쳐 수정될 때, 기존의 숫자 기반 시퀀스 주석(`// [SEQUENCE: 123]`)은 새로운 MVP 시퀀스 주석으로 대체(제거 후 추가)합니다. 하지만, 한번 작성된 **MVP 기반 시퀀스 주석(`// [SEQUENCE: MVPX-Y]`)은 절대 수정하거나 삭제하지 않습니다.** 대신, 해당 기능에 대한 후속 MVP의 변경 사항이 생기면, 관련된 **새로운 MVP 시퀀스 주석을 기존 주석 아래에 추가**하여 코드의 변경 이력을 보존합니다.

### 4. 핵심 작업 절차 (Core Workflow - 각 MVP에 반복)
*   **상세 설명 원칙 (Detailed Explanation Principle):** 각 `DevHistory` 문서 작성 시, 단순히 시퀀스 목록을 나열하는 것을 넘어, 해당 MVP의 핵심 기능들에 대한 설계 목표, 기술적 선택 이유, 그리고 기대 효과 등을 설명하는 개요 단락을 반드시 포함해야 합니다. 이는 코드의 '무엇'을 넘어 '왜'를 설명하기 위함입니다.
*   **문서 검토 (Review Document):** 해당 MVP의 `DevHistoryXX.md` 파일을 읽고, 명시된 시퀀스 번호와 파일 목록을 파악합니다. 문서 자체의 논리적 오류(번호 중복 등)를 먼저 확인합니다.
*   **코드 검증 (Verify Code):** `grep`을 사용하여 `src` 디렉토리 내에 해당 MVP의 시퀀스 번호가 문서와 일치하게 존재하는지 확인합니다.
*   **불일치 해결 계획 수립 (Plan Discrepancy Resolution):** 문서와 코드 간의 불일치(누락, 중복, 오류)가 발견되면, 이를 해결하기 위한 종합적인 계획을 먼저 수립하여 사용자에게 제시하고 승인을 받습니다. 여기에는 시퀀스 번호 재정렬, 누락된 파일 내용 추가 등이 포함될 수 있습니다.
*   **계획 실행 (Execute Plan):** 승인된 계획에 따라, 코드(`src`)와 문서(`DevHistoryXX.md`)를 모두 수정하여 동기화합니다.
*   **문서-코드 주석 일치 (Comment Synchronization):** `DevHistory` 문서에 포함되는 모든 시퀀스 주석은, 대응하는 소스 코드의 주석과 글자 하나까지 정확히 일치해야 합니다. 범위 요약(A~B)은 허용되지 않습니다.
*   **전체 내용 보존 (Preserve Full Content):** 파일 수정 시, 특정 부분만 변경하더라도 나머지 내용이 절대 유실되지 않도록 항상 전체 내용을 보존하여 작업합니다.
*   **구현 및 테스트:**
    *   **TDD 접근법:** 새로운 기능 추가 또는 버그 수정 시, 먼저 실패하는 유닛 테스트를 작성하고, 그 다음 테스트를 통과하는 최소한의 코드를 작성한 후, 마지막으로 코드를 리팩토링하는 테스트 주도 개발(TDD) 방식을 적극적으로 활용한다.
    *   해당 MVP의 기능이 코드에 누락되었다면, 문서를 바탕으로 새로 구현한다. (예: `OptimizedWorld`의 비어있는 메서드 채우기)
    *   해당 MVP와 관련된 유닛 테스트(`tests/unit/`)가 있다면, 이를 활성화하고 동기화된 코드에 맞게 테스트 코드를 수정하거나 재작성한다.
    *   해당 유닛 테스트를 포함한 빌드가 100% 성공할 때까지 디버깅을 반복한다.
*   **MVP 완료 및 검증 기록:**
    *   최종적으로 **해당 MVP 범위 내의 모든 코드가 포함된 상태에서 100% 빌드 성공**을 확인한다.
    *   `git tag -a MVPX -m "MVP X build successful"` 명령을 사용하여 현재 상태를 태그로 저장한다.
    *   `DevHistoryXX.md` 문서의 마지막에, 이 성공적인 빌드 경험과 주요 조치 사항을 상세히 기술한 **"빌드 검증" 섹션을 반드시 추가**한다. 이로써 해당 MVP 작업이 공식적으로 완료되었음을 선언한다.

### 5. 코드 수정 원칙 (Code Modification Principles)
*   **코드 생성 (Code Generation):** 문서화 과정에서 MVP 기능 구현에 필요한 소스 파일(.h 또는 .cpp)이 없는 경우, 새로운 파일을 직접 생성하는 것은 허용됩니다.
*   **코드 보존 (Code Preservation):** 기존 코드를 수정하거나 리팩토링하는 것은 허용되지만, 기능하는 기존 코드를 삭제하는 것은 절대 금지됩니다. 파일의 목적이 더 이상 유효하지 않다면, 명시적인 확인 없이 내용을 삭제하지 말고 사용 중단(deprecation)으로 표시하십시오.
*   **진실의 원천 (백업) (Source of Truth (Backup)):** 파일 손상 또는 의도치 않은 삭제 시, 읽기 전용 백업 디렉토리 (`/home/woopinbells/Desktop/tmp-git-origin/clear-claude-prompt/use-portfolio/cpp-multiplayer-game-server`)를 최종적인 복원 소스로 사용해야 합니다.

### 6. 세션 재개 프로토콜 (Session Resumption Protocol)
작업이 중단된 후 새로운 세션에서 재개할 경우, 다음 절차를 반드시 따르십시오.
1.  **목표 식별 (Identify Goal):** 사용자의 프롬프트(예: "DevHistoryRule.md문서를 읽고 X버전부터 작업을 이어나가세요.")를 통해 시작할 MVP 버전을 확인합니다.
2.  **규칙 내재화 (Internalize Rules):** 이 문서(`DevHistoryRule.md`)의 모든 규칙을 읽고 완전히 이해합니다.
3.  **상태 평가 (파일 분석) (Assess State (File Analysis)):** 작업 디렉토리 (`/home/woopinbells/Desktop/tmp/clear-claude-prompt/use-portfolio/cpp-multiplayer-game-server`)에서 대상 MVP 시퀀스(예: `grep -r "MVP-X-"`)에 대한 `grep` 검색을 수행하여 현재 버전과 관련된 모든 파일을 식별합니다.
4.  **상태 평가 (기록 검토) (Assess State (History Review)):** 해당 `DevHistoryXX.md` 파일(예: `DevHistory0X.md`)을 읽어 해당 버전의 개발 컨텍스트와 목표를 이해합니다.
5.  **계획 수립 (Formulate Plan):** 규칙, 파일 상태, 개발 기록을 바탕으로 작업을 계속하기 위한 계획을 수립합니다.
6.  **실행 (Execute):** 수립된 모든 코드 수정 및 보존 원칙을 준수하며 계획을 실행합니다.

### 7. 프로덕션 고려사항 및 개선 제안 (Production Considerations & Improvement Notes)
*   각 MVP 문서의 말미에는, 해당 기능들을 실제 프로덕션 환경에서 운영하기 위해 필요한 추가적인 고려사항을 구체적인 코드 예시와 함께 상세히 기술합니다.
*   코드 개선 제안 사항이 있을 경우, `#### 개선 제안 (Improvement Notes):` 섹션에 별도로 명시합니다.

### 8. 최소 변경 및 즉시 검증 원칙 (Principle of Minimal Change & Immediate Verification)
*   **8.1. `replace` 도구 사용 제한:** 파일 전체 또는 여러 줄에 걸친 광범위한 `replace` 작업은 원칙적으로 금지한다. `replace`는 반드시 단일 행(single-line) 또는 매우 작은, 명확히 식별되는 코드 블록을 대상으로만 사용해야 한다.
*   **8.2. `write_file` 기반 수정:** 여러 줄 수정 시, `read_file`로 현재 내용을 읽고, 수정한 뒤, `write_file`로 전체를 덮어쓴다. 작업 직후에는 반드시 `diff`로 변경 사항을 검증한다.

### 9. MVP 복구 및 재문서화 절차 (MVP Recovery & Redocumentation Procedure)
기존 `DevHistory` 문서가 부정확하거나, 관련 소스 코드가 누락 또는 불완전한 MVP를 처음부터 재정비할 때 사용하는 절차이다. 이 절차는 코드로부터 문서를 재구성하여 100%의 정확성을 보장하는 것을 목표로 한다.
1.  **코드 우선 탐색 (Code-First Discovery):** `glob`과 `search_file_content`를 사용하여 해당 MVP의 주제(예: "네트워킹", "ECS")와 관련된 모든 소스 파일을 찾는다. 이것이 해당 MVP의 범위를 정의하는 가장 정확한 기준이 된다.
2.  **누락 코드 생성 (Generation of Missing Code):** 만약 MVP의 핵심 기능에 필수적인 소스 파일이 누락된 경우(예: MVP 1의 `tcp_server.h`), 프로젝트 아키텍처와 다른 문서를 참고하여 해당 파일을 직접 생성한다.
3.  **문서 재설계 및 상세화 (Redesign and Detail Documentation):** 탐색 및 생성된 모든 파일을 기반으로, `DevHistoryXX.md` 문서를 완전히 새로 작성한다. 각 기능 그룹에 대한 명확한 개요와 "왜"를 설명하는 상세한 설명을 포함해야 한다.
4.  **코드-문서 완전 동기화 (Full Code-Doc Sync):** 재설계된 문서를 기준으로, 관련된 모든 소스 코드 파일에 `MVPX-Y` 형식의 새롭고 일관된 시퀀스 번호를 부여한다. 이 과정에서 기존의 모든 낡은 주석은 제거되거나 새로운 주석으로 대체된다.

### 10. MVP 완료 및 검증 기록 (MVP Completion and Verification Record)
*   최종적으로 **해당 MVP 범위 내의 모든 코드가 포함된 상태에서 100% 빌드 성공**을 확인한다.
*   `git tag -a MVPX -m "MVP X build successful"` 명령을 사용하여 현재 상태를 태그로 저장한다.
*   **이전 버전 참조:** 새로운 MVP 작업 시, 이전 버전의 코드베이스를 참조해야 할 경우, 해당 MVP의 Git 태그를 활용하여 정확한 시점을 확인한다.
*   `DevHistoryXX.md` 문서의 마지막에, 이 성공적인 빌드 경험과 주요 조치 사항을 상세히 기술한 **"빌드 검증" 섹션을 반드시 추가**한다. 이로써 해당 MVP 작업이 공식적으로 완료되었음을 선언한다.
*   **TDD(테스트 주도 개발) 접근법을 따르므로, '빌드 검증' 섹션에는 최종 성공 여부뿐만 아니라, 목표 달성 과정에서 수행된 주요 테스트 내용, 테스트 중 발견된 문제점, 그리고 이를 해결하기 위한 디버깅 선택과 그 근거를 상세히 기록해야 합니다. 이는 단순한 결과 보고를 넘어, 문제 해결 과정 전체를 투명하게 공유하고 프로젝트의 중요한 역사적 자산으로 남기기 위함입니다.**

### 11. 빌드 오류 해결 절차 (Build Error Resolution Procedure)
빌드 실패 시, 다음 절차에 따라 체계적으로 문제를 해결한다.
1.  **오류 메시지 분석:** 컴파일러 또는 링커가 출력하는 오류 메시지를 정확히 읽고 문제의 원인을 파악한다.
2.  **최소 단위 재현:** 문제가 발생한 코드를 격리하여 최소한의 예제로 재현해본다. 이를 통해 문제의 범위를 좁히고 원인을 명확히 할 수 있다.
3.  **의존성 확인:** `CMakeLists.txt`와 `conanfile.txt`를 검토하여 필요한 라이브러리가 올바르게 설정되고 링크되었는지 확인한다.
4.  **점진적 해결:** 한 번에 하나의 오류를 해결하고, 해결될 때마다 빌드를 다시 시도하여 문제가 해결되었는지 확인한다.

### 12. 기술 면접 대비를 위한 심층 문서화 (In-depth Documentation for Technical Interviews)
`DevHistory` 문서의 '상세 설명 원칙'과 '프로덕션 고려사항'을 작성할 때, 이는 단순히 기록을 넘어, **미래의 기술 면접관에게 설명하는 것을 가정하고 작성한다.** 각 기술 선택의 트레이드오프(trade-offs), 구현 과정에서 겪은 어려운 점, 그리고 만약 다시 만든다면 다르게 할 점 등을 포함하여 기술적 깊이를 증명하는 데 초점을 맞춘다.